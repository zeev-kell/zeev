/**
 * zeev - Sun Oct 16 2016 17:57:42 GMT+0800 (中国标准时间)
 * @version v0.0.0
 */

!function(e){"use strict";e.module("app",["ui.router","ui.router.stateHelper","ngCookies","ngSanitize","ui.bootstrap","oc.lazyLoad","ngAnimate","vBusy","ngSweetAlertFull","angular-loading-bar","app.config","app.service","app.directive","app.controller","app.component"])}(angular),angular.module("app.config",[]),angular.module("app.config").config(["$logProvider",function(e){e.debugEnabled(!0)}]).config(["$httpProvider","cfpLoadingBarProvider",function(e,a){a.includeSpinner=!0,a.includeBar=!0,a.parentSelector="#loading-bar-container",e.interceptors.push("httpInterceptor")}]),angular.module("app.config").config(["$ocLazyLoadProvider",function(e){var a="/public/libs/",n="/bower_components/";e.config({debug:!1,events:!1,modules:[{name:"akoenig.deckgrid",files:[n+"angular-deckgrid/angular-deckgrid.js",a+"css/deckgrid.css"]},{name:"d3",files:[n+"d3/d3.js"]},{name:"showdown",files:[n+"showdown/compressed/Showdown.js"]}]})}]);var lazyLoadState=function(e){return e.src&&(e.resolve=angular.extend(e.resolve||{},{lazyLoad:["$ocLazyLoad",function(a){return a.load(e.src)}]})),e};angular.module("app.config").config(["$stateProvider","$urlRouterProvider","stateHelperProvider",function(e,a,n){a.otherwise("/"),e.state("index",lazyLoadState({url:"/",templateUrl:"views/index.html"})),n.state(lazyLoadState({name:"home",url:"/home",templateUrl:"views/home/index.html",children:[lazyLoadState({name:"notice",url:"/notice",templateUrl:"views/home/notice.html"})]})).state(lazyLoadState({name:"essay",url:"/essay",templateUrl:"views/essay/index.html",children:[lazyLoadState({name:"list",url:"/list",src:["controller/essay/list.js","akoenig.deckgrid"],templateUrl:"views/essay/list.html",controller:"essayListCtrl as eLCtrl"}),lazyLoadState({name:"new",url:"/new",src:["controller/essay/new.js","showdown"],templateUrl:"views/essay/new.html",controller:"essayNewCtrl as eNCtrl"}),lazyLoadState({name:"info",url:"/info/:id",src:["controller/essay/info.js"],templateUrl:"views/essay/info.html",controller:"essayInfoCtrl as eICtrl"}),lazyLoadState({name:"editor",url:"/editor/:id",src:["controller/essay/editor.js","showdown"],templateUrl:"views/essay/editor.html",controller:"essayEditorCtrl as eECtrl"})]}))}]).run(["$rootScope","$state","$stateParams","$urlRouter",function(e,a,n,t){e.$state=a,e.$stateParams=n,e.$on("$stateChangeStart",function(e,a,n,t,o,r){}),e.$on("$locationChangeSuccess",function(e,a,n,t,o,r){})}]),angular.module("app.service",[]),angular.module("app.service").run(["$rootScope","authorizationService",function(e,a){e.user=a,e.authorizationService=a}]).service("authorizationService",["$q","$rootScope","$http","$window","$location","$log",function(e,a,n,t,o,r){this.setToken=function(e){window.localStorage.setItem("adminToken",JSON.stringify(e)),this.token=e},this.getToken=function(){return this.token},this.refreshToken=function(){this.checkToken().then(function(){})},this.toSingin=function(e){e&&e.preventDefault(),window.localStorage.removeItem("adminToken"),r.log("toSingin"),t.location.href="/singin.html"},this.checkToken=function(e){if("string"==typeof localStorage.adminToken){var a;try{a=JSON.parse(localStorage.adminToken)}catch(e){}return!(!a||"number"!=typeof a.expireAt||!moment().isBefore(1e3*a.expireAt))&&(this.token=a,a)}return!1},this.checkToken()}]),angular.module("app.service").service("httpInterceptor",["$q","$rootScope","$log","$window",function(e,a,n,t){this.request=function(e){e.headers=e.headers||{};var n=a.authorizationService.getToken();return n&&(e.headers.Authorization="Bearer "+n.accessToken,e.headers["Accept-Language"]="en"),e},this.response=function(e){return e},this.requestError=function(e){n.log("请求发生了错误: ",e)},this.responseError=function(a){return n.log("响应发生了错误: ",a),e.reject(a)}}]),angular.module("app.directive",[]),angular.module("app.directive").directive("barMenu",["$animateCss","$timeout",function(e,a){return{restrict:"AE",controller:["$scope","$element",function(n,t){var o=this;o.collapse=function(a){var n=a.children("ul"),t=n.children();return n.hasClass("collapse")||n.hasClass("in")?(t.addClass("hidden-item"),n.css({height:n[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),void e(n,{removeClass:"in",to:{height:"0"}}).start().finally(function(){n.css({height:"0"}).removeClass("collapsing").addClass("collapse"),t.removeClass("hidden-item"),a.removeClass("expanded")})):(n.css({height:"0"}).removeClass("collapsing").addClass("collapse"),void a.removeClass("expanded"))},o.expand=function(n){o.timeout&&a.cancel(o.timeout);var t=n.children("ul"),r=t.children();if(!t.hasClass("collapse")||!t.hasClass("in")){var s=n.siblings(".expanded");s.length>0&&o.collapse(s),n.addClass("expanded"),t.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),r.addClass("is-hidden"),e(t,{addClass:"in",easing:"ease",to:{height:t[0].scrollHeight+"px"}}).start().finally(function(){t.removeClass("collapsing").addClass("collapse").css({height:"auto"}),e(r,{addClass:"is-shown"}).start().finally(function(){r.removeClass("is-hidden is-shown")})})}}}],link:function(e,n,t,o){var r=angular.element(n).find("li:has(> ul)");r.addClass("has-sub"),r.each(function(e,a){a=angular.element(a),a.children("a").on("click",function(e){a.hasClass("expanded")?o.collapse(a):o.expand(a)})}),o.timeout=a(function(){var e=angular.element(n).find("li.active");e.length>0&&(e.parent().parent().parent().parent().parent().hasClass("main-menu")?(o.expand(e.parent().parent().parent().parent()),o.expand(e.parent().parent())):o.expand(e.parent().parent()))},1e3)}}}]),angular.module("app.directive").directive("layoutLoading",["$rootScope",function(e){return{restrict:"AE",link:function(a,n,t){e.$on("$stateChangeStart",function(){n.removeClass("ng-hide")}),e.$on("$stateChangeSuccess",function(){n.addClass("ng-hide")}),e.$on("$stateNotFound",function(){n.addClass("ng-hide")}),e.$on("$stateChangeError",function(){n.addClass("ng-hide")})}}}]),angular.module("app.controller",[]),angular.module("app.component",[]);